<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<style>
		*{
			margin: 0;
			padding: 0;
		}
		div{
			width: 600px;
			height: 400px;
			background: #000;
			margin: 100px auto;
			padding: 100px 100px;
		}
		table{
			border-collapse: collapse;
			background-color: black;
			float: left;
			border-radius: 3px;
		}
		td{
			width: 20px;
			height: 20px;
			border: 1px solid #ccc;

		}
		span{
			float: right;
			width: 100px;
			height: 50px;
			background: #fff;
			color: red;
			font-size: 20px;
			font-weight: bold;
			text-align: center;
			line-height: 50px;
			border-radius: 4px;
		}
	</style>
</head>
<body>
	<div>
		<table>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
		</table>
		<span>得分:0</span>
	</div>
	<audio src="eat.mp3" id="eat"></audio>
	<audio src="die.mp3" id="die"></audio>
	<audio src="bgm.mp3" autoplay loop controls></audio>
</body>
</html>
<script>
	var snake = [[3,9], [3,8], [3,7], [3,6], [3,5]];
	var x = 3;
	var y = 9;
	var direction = "right";
	var _direction = "right";
	var a;
	var b;
	var k;
	var isCreatFood = true;
	var sorce = 0;
	var color = ["#85fe85", "#fefd5e", "#fe5efe", "#ff5f5f", "#5e5eff"];
	//创建食物
	function creatFood(){
		k = parseInt(Math.random() * 5);
		do{
			a = parseInt(Math.random() * 20);
			b = parseInt(Math.random() * 20);
			var isExisted = false;
			for(var i = 0; i < snake.length; i++){
				if(a == snake[i][0] && b == snake[i][1]){
					isExisted = true;
				}
			}
		}while(isExisted);
	}

	//画蛇
	function drawSnake(snake){
		document.getElementsByTagName("tr")[snake[0][0]].getElementsByTagName('td')[snake[0][1]].style.background = "white";
		for (var i = 1; i < snake.length; i++) {
			document.getElementsByTagName("tr")[snake[i][0]].getElementsByTagName('td')[snake[i][1]].style.background = "skyblue";
		}
	}
	// 清屏
	function clearScreen(){
		for (var i = 0; i < 20; i++) {
			for (var j = 0; j < 20; j++) {
				document.getElementsByTagName("tr")[i].getElementsByTagName('td')[j].style.background = "black";
				}
		}
	}
	//gameover
	function goDie(){
		document.getElementById("die").play();
		alert("GAME OVER!");
		clearInterval(timer);
	}

	drawSnake(snake);

	//定时器
	var timer = setInterval(function(){
		clearScreen();
		//判断方向
		document.onkeydown = function(e){
			var code = e.keyCode;
			_direction = direction;
			switch(code){
				case 37:
					if(_direction != "right") _direction = "left";
					break;
				case 38:
					if(_direction != "down") _direction = "up";
					break;
				case 39:
					if(_direction != "let") _direction = "right";
					break;
				case 40:
					if(_direction != "up") _direction = "down";
					break;
			}
		}
		//解决bug
		if(direction == "right" && _direction != "left"){
				direction = _direction;
			}else if(direction == "left" && _direction != "right"){
				direction = _direction;
			}else if(direction == "up" && _direction != "down"){
				direction = _direction;
			}else if(direction == "down" && _direction != "up"){
				direction = _direction;
			}
		switch(direction){
			case "left":
				snake.unshift([snake[0][0], snake[0][1]-1]);
				if(snake[0][1] < 0) goDie();
			break;
			case "right":
				snake.unshift([snake[0][0], snake[0][1]+1]);
				if(snake[0][1] == 20) goDie();
			break;
			case "up":
				snake.unshift([snake[0][0]-1, snake[0][1]]);
				if(snake[0][0] < 0) goDie();
			break;
			case "down":
				snake.unshift([snake[0][0]+1, snake[0][1]]);
				if(snake[0][0] == 20) goDie();
			break;
		}
		//判断goDie
		for(var i = 1; i < snake.length; i++){
			if(snake[0][0] == snake[i][0] && snake[0][1] == snake[i][1]){
				goDie();
			}
		}
		//吃食物
		if(snake[0][0] == a && snake[0][1] == b){
			document.getElementById("eat").play();
			isCreatFood = true;
			sorce++;
		}else{
		snake.pop();
		}
		//是否要创建新的食物
		if(isCreatFood){
			creatFood();
			isCreatFood = false;
		}
		document.getElementsByTagName('span')[0].innerHTML = "得分:" + sorce;
		document.getElementsByTagName("tr")[a].getElementsByTagName('td')[b].style.background = color[k];
		drawSnake(snake);
	}, 200)
</script>